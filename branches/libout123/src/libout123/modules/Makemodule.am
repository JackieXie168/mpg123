# Module for non-recursive mpg123 build system.
# Gah! Not even re-defining that variable is allowed in automake!
# I WANT TO USE PROPER MAKE!
# makedir := src/libout123/modules
# Experiment: Does automake pick that up in a Make variable?
# Damn, no! It complains wildly.
# I just want to use GNU Make and be done with it!
# Perhaps the next build system rewrite ...
#makenam=src_libout123_modules

out123src += \
  src/libout123/modules/aix.c \
  src/libout123/modules/alib.c \
  src/libout123/modules/alsa05.c \
  src/libout123/modules/alsa.c \
  src/libout123/modules/arts.c \
  src/libout123/modules/coreaudio.c \
  src/libout123/modules/dummy.c \
  src/libout123/modules/esd.c \
  src/libout123/modules/hp.c \
  src/libout123/modules/jack.c \
  src/libout123/modules/libao.c \
  src/libout123/modules/mint.c \
  src/libout123/modules/nas.c \
  src/libout123/modules/openal.c \
  src/libout123/modules/os2.c \
  src/libout123/modules/oss.c \
  src/libout123/modules/portaudio.c \
  src/libout123/modules/pulse.c \
  src/libout123/modules/sdl.c \
  src/libout123/modules/sgi.c \
  src/libout123/modules/sndio.c \
  src/libout123/modules/sun.c \
  src/libout123/modules/win32.c

#Do not include uneeded headers from mpg123app.h
libout123_mod_cppflags = -DBUILDING_OUTPUT_MODULES=1

if HAVE_MODULES

# These are not tested and _very_ likely need work: aix alib hp os2 sgi mint

# Use that sh/perl script to generate the module entries:
#echo "alsa coreaudio esd jack nas oss \
#portaudio pulse sdl sndio sun win32 \
#aix alib arts hp os2 sgi mint openal \
#dummy" | tr ' ' '\n' |
#perl -ne 'chomp; $big = uc($_); print <<EOT;
#
#if HAVE_$big
#pkglib_LTLIBRARIES += \src/libout123/modules/output_$_.la
#src_libout123_modules_output_${_}_la_SOURCES = \src/libout123/modules/$_.c
#src_libout123_modules_output_${_}_la_LDFLAGS = -module -no-undefined -avoid-version -export-dynamic  -export-symbols-regex '"'"'^mpg123_'"'"' \@${big}_LDFLAGS\@
#src_libout123_modules_output_${_}_la_CFLAGS  = \@${big}_CFLAGS\@
#src_libout123_modules_output_${_}_la_LIBADD  = \@${big}_LIBS\@
#src_libout123_modules_outout_${_}_la_CPPFLAGS = \$(libout123_mod_cppflags)
#endif
#EOT
#'

if HAVE_ALSA
pkglib_LTLIBRARIES += src/libout123/modules/output_alsa.la
src_libout123_modules_output_alsa_la_SOURCES = src/libout123/modules/alsa.c
src_libout123_modules_output_alsa_la_LDFLAGS = -module -no-undefined -avoid-version -export-dynamic  -export-symbols-regex '^mpg123_' @ALSA_LDFLAGS@
src_libout123_modules_output_alsa_la_CFLAGS  = @ALSA_CFLAGS@
src_libout123_modules_output_alsa_la_LIBADD  = @ALSA_LIBS@
src_libout123_modules_outout_alsa_la_CPPFLAGS = $(libout123_mod_cppflags)
endif

if HAVE_COREAUDIO
pkglib_LTLIBRARIES += src/libout123/modules/output_coreaudio.la
src_libout123_modules_output_coreaudio_la_SOURCES = src/libout123/modules/coreaudio.c
src_libout123_modules_output_coreaudio_la_LDFLAGS = -module -no-undefined -avoid-version -export-dynamic  -export-symbols-regex '^mpg123_' @COREAUDIO_LDFLAGS@
src_libout123_modules_output_coreaudio_la_CFLAGS  = @COREAUDIO_CFLAGS@
src_libout123_modules_output_coreaudio_la_LIBADD  = @COREAUDIO_LIBS@
src_libout123_modules_outout_coreaudio_la_CPPFLAGS = $(libout123_mod_cppflags)
endif

if HAVE_ESD
pkglib_LTLIBRARIES += src/libout123/modules/output_esd.la
src_libout123_modules_output_esd_la_SOURCES = src/libout123/modules/esd.c
src_libout123_modules_output_esd_la_LDFLAGS = -module -no-undefined -avoid-version -export-dynamic  -export-symbols-regex '^mpg123_' @ESD_LDFLAGS@
src_libout123_modules_output_esd_la_CFLAGS  = @ESD_CFLAGS@
src_libout123_modules_output_esd_la_LIBADD  = @ESD_LIBS@
src_libout123_modules_outout_esd_la_CPPFLAGS = $(libout123_mod_cppflags)
endif

if HAVE_JACK
pkglib_LTLIBRARIES += src/libout123/modules/output_jack.la
src_libout123_modules_output_jack_la_SOURCES = src/libout123/modules/jack.c
src_libout123_modules_output_jack_la_LDFLAGS = -module -no-undefined -avoid-version -export-dynamic  -export-symbols-regex '^mpg123_' @JACK_LDFLAGS@
src_libout123_modules_output_jack_la_CFLAGS  = @JACK_CFLAGS@
src_libout123_modules_output_jack_la_LIBADD  = @JACK_LIBS@
src_libout123_modules_outout_jack_la_CPPFLAGS = $(libout123_mod_cppflags)
endif

if HAVE_NAS
pkglib_LTLIBRARIES += src/libout123/modules/output_nas.la
src_libout123_modules_output_nas_la_SOURCES = src/libout123/modules/nas.c
src_libout123_modules_output_nas_la_LDFLAGS = -module -no-undefined -avoid-version -export-dynamic  -export-symbols-regex '^mpg123_' @NAS_LDFLAGS@
src_libout123_modules_output_nas_la_CFLAGS  = @NAS_CFLAGS@
src_libout123_modules_output_nas_la_LIBADD  = @NAS_LIBS@
src_libout123_modules_outout_nas_la_CPPFLAGS = $(libout123_mod_cppflags)
endif

if HAVE_OSS
pkglib_LTLIBRARIES += src/libout123/modules/output_oss.la
src_libout123_modules_output_oss_la_SOURCES = src/libout123/modules/oss.c
src_libout123_modules_output_oss_la_LDFLAGS = -module -no-undefined -avoid-version -export-dynamic  -export-symbols-regex '^mpg123_' @OSS_LDFLAGS@
src_libout123_modules_output_oss_la_CFLAGS  = @OSS_CFLAGS@
src_libout123_modules_output_oss_la_LIBADD  = @OSS_LIBS@
src_libout123_modules_outout_oss_la_CPPFLAGS = $(libout123_mod_cppflags)
endif

if HAVE_PORTAUDIO
pkglib_LTLIBRARIES += src/libout123/modules/output_portaudio.la
src_libout123_modules_output_portaudio_la_SOURCES = src/libout123/modules/portaudio.c
src_libout123_modules_output_portaudio_la_LDFLAGS = -module -no-undefined -avoid-version -export-dynamic  -export-symbols-regex '^mpg123_' @PORTAUDIO_LDFLAGS@
src_libout123_modules_output_portaudio_la_CFLAGS  = @PORTAUDIO_CFLAGS@
src_libout123_modules_output_portaudio_la_LIBADD  = @PORTAUDIO_LIBS@
src_libout123_modules_outout_portaudio_la_CPPFLAGS = $(libout123_mod_cppflags)
endif

if HAVE_PULSE
pkglib_LTLIBRARIES += src/libout123/modules/output_pulse.la
src_libout123_modules_output_pulse_la_SOURCES = src/libout123/modules/pulse.c
src_libout123_modules_output_pulse_la_LDFLAGS = -module -no-undefined -avoid-version -export-dynamic  -export-symbols-regex '^mpg123_' @PULSE_LDFLAGS@
src_libout123_modules_output_pulse_la_CFLAGS  = @PULSE_CFLAGS@
src_libout123_modules_output_pulse_la_LIBADD  = @PULSE_LIBS@
src_libout123_modules_outout_pulse_la_CPPFLAGS = $(libout123_mod_cppflags)
endif

if HAVE_SDL
pkglib_LTLIBRARIES += src/libout123/modules/output_sdl.la
src_libout123_modules_output_sdl_la_SOURCES = src/libout123/modules/sdl.c
src_libout123_modules_output_sdl_la_LDFLAGS = -module -no-undefined -avoid-version -export-dynamic  -export-symbols-regex '^mpg123_' @SDL_LDFLAGS@
src_libout123_modules_output_sdl_la_CFLAGS  = @SDL_CFLAGS@
src_libout123_modules_output_sdl_la_LIBADD  = @SDL_LIBS@
src_libout123_modules_outout_sdl_la_CPPFLAGS = $(libout123_mod_cppflags)
endif

if HAVE_SNDIO
pkglib_LTLIBRARIES += src/libout123/modules/output_sndio.la
src_libout123_modules_output_sndio_la_SOURCES = src/libout123/modules/sndio.c
src_libout123_modules_output_sndio_la_LDFLAGS = -module -no-undefined -avoid-version -export-dynamic  -export-symbols-regex '^mpg123_' @SNDIO_LDFLAGS@
src_libout123_modules_output_sndio_la_CFLAGS  = @SNDIO_CFLAGS@
src_libout123_modules_output_sndio_la_LIBADD  = @SNDIO_LIBS@
src_libout123_modules_outout_sndio_la_CPPFLAGS = $(libout123_mod_cppflags)
endif

if HAVE_SUN
pkglib_LTLIBRARIES += src/libout123/modules/output_sun.la
src_libout123_modules_output_sun_la_SOURCES = src/libout123/modules/sun.c
src_libout123_modules_output_sun_la_LDFLAGS = -module -no-undefined -avoid-version -export-dynamic  -export-symbols-regex '^mpg123_' @SUN_LDFLAGS@
src_libout123_modules_output_sun_la_CFLAGS  = @SUN_CFLAGS@
src_libout123_modules_output_sun_la_LIBADD  = @SUN_LIBS@
src_libout123_modules_outout_sun_la_CPPFLAGS = $(libout123_mod_cppflags)
endif

if HAVE_WIN32
pkglib_LTLIBRARIES += src/libout123/modules/output_win32.la
src_libout123_modules_output_win32_la_SOURCES = src/libout123/modules/win32.c
src_libout123_modules_output_win32_la_LDFLAGS = -module -no-undefined -avoid-version -export-dynamic  -export-symbols-regex '^mpg123_' @WIN32_LDFLAGS@
src_libout123_modules_output_win32_la_CFLAGS  = @WIN32_CFLAGS@
src_libout123_modules_output_win32_la_LIBADD  = @WIN32_LIBS@
src_libout123_modules_outout_win32_la_CPPFLAGS = $(libout123_mod_cppflags)
endif

if HAVE_AIX
pkglib_LTLIBRARIES += src/libout123/modules/output_aix.la
src_libout123_modules_output_aix_la_SOURCES = src/libout123/modules/aix.c
src_libout123_modules_output_aix_la_LDFLAGS = -module -no-undefined -avoid-version -export-dynamic  -export-symbols-regex '^mpg123_' @AIX_LDFLAGS@
src_libout123_modules_output_aix_la_CFLAGS  = @AIX_CFLAGS@
src_libout123_modules_output_aix_la_LIBADD  = @AIX_LIBS@
src_libout123_modules_outout_aix_la_CPPFLAGS = $(libout123_mod_cppflags)
endif

if HAVE_ALIB
pkglib_LTLIBRARIES += src/libout123/modules/output_alib.la
src_libout123_modules_output_alib_la_SOURCES = src/libout123/modules/alib.c
src_libout123_modules_output_alib_la_LDFLAGS = -module -no-undefined -avoid-version -export-dynamic  -export-symbols-regex '^mpg123_' @ALIB_LDFLAGS@
src_libout123_modules_output_alib_la_CFLAGS  = @ALIB_CFLAGS@
src_libout123_modules_output_alib_la_LIBADD  = @ALIB_LIBS@
src_libout123_modules_outout_alib_la_CPPFLAGS = $(libout123_mod_cppflags)
endif

if HAVE_ARTS
pkglib_LTLIBRARIES += src/libout123/modules/output_arts.la
src_libout123_modules_output_arts_la_SOURCES = src/libout123/modules/arts.c
src_libout123_modules_output_arts_la_LDFLAGS = -module -no-undefined -avoid-version -export-dynamic  -export-symbols-regex '^mpg123_' @ARTS_LDFLAGS@
src_libout123_modules_output_arts_la_CFLAGS  = @ARTS_CFLAGS@
src_libout123_modules_output_arts_la_LIBADD  = @ARTS_LIBS@
src_libout123_modules_outout_arts_la_CPPFLAGS = $(libout123_mod_cppflags)
endif

if HAVE_HP
pkglib_LTLIBRARIES += src/libout123/modules/output_hp.la
src_libout123_modules_output_hp_la_SOURCES = src/libout123/modules/hp.c
src_libout123_modules_output_hp_la_LDFLAGS = -module -no-undefined -avoid-version -export-dynamic  -export-symbols-regex '^mpg123_' @HP_LDFLAGS@
src_libout123_modules_output_hp_la_CFLAGS  = @HP_CFLAGS@
src_libout123_modules_output_hp_la_LIBADD  = @HP_LIBS@
src_libout123_modules_outout_hp_la_CPPFLAGS = $(libout123_mod_cppflags)
endif

if HAVE_OS2
pkglib_LTLIBRARIES += src/libout123/modules/output_os2.la
src_libout123_modules_output_os2_la_SOURCES = src/libout123/modules/os2.c
src_libout123_modules_output_os2_la_LDFLAGS = -module -no-undefined -avoid-version -export-dynamic  -export-symbols-regex '^mpg123_' @OS2_LDFLAGS@
src_libout123_modules_output_os2_la_CFLAGS  = @OS2_CFLAGS@
src_libout123_modules_output_os2_la_LIBADD  = @OS2_LIBS@
src_libout123_modules_outout_os2_la_CPPFLAGS = $(libout123_mod_cppflags)
endif

if HAVE_SGI
pkglib_LTLIBRARIES += src/libout123/modules/output_sgi.la
src_libout123_modules_output_sgi_la_SOURCES = src/libout123/modules/sgi.c
src_libout123_modules_output_sgi_la_LDFLAGS = -module -no-undefined -avoid-version -export-dynamic  -export-symbols-regex '^mpg123_' @SGI_LDFLAGS@
src_libout123_modules_output_sgi_la_CFLAGS  = @SGI_CFLAGS@
src_libout123_modules_output_sgi_la_LIBADD  = @SGI_LIBS@
src_libout123_modules_outout_sgi_la_CPPFLAGS = $(libout123_mod_cppflags)
endif

if HAVE_MINT
pkglib_LTLIBRARIES += src/libout123/modules/output_mint.la
src_libout123_modules_output_mint_la_SOURCES = src/libout123/modules/mint.c
src_libout123_modules_output_mint_la_LDFLAGS = -module -no-undefined -avoid-version -export-dynamic  -export-symbols-regex '^mpg123_' @MINT_LDFLAGS@
src_libout123_modules_output_mint_la_CFLAGS  = @MINT_CFLAGS@
src_libout123_modules_output_mint_la_LIBADD  = @MINT_LIBS@
src_libout123_modules_outout_mint_la_CPPFLAGS = $(libout123_mod_cppflags)
endif

if HAVE_OPENAL
pkglib_LTLIBRARIES += src/libout123/modules/output_openal.la
src_libout123_modules_output_openal_la_SOURCES = src/libout123/modules/openal.c
src_libout123_modules_output_openal_la_LDFLAGS = -module -no-undefined -avoid-version -export-dynamic  -export-symbols-regex '^mpg123_' @OPENAL_LDFLAGS@
src_libout123_modules_output_openal_la_CFLAGS  = @OPENAL_CFLAGS@
src_libout123_modules_output_openal_la_LIBADD  = @OPENAL_LIBS@
src_libout123_modules_outout_openal_la_CPPFLAGS = $(libout123_mod_cppflags)
endif

if HAVE_DUMMY
pkglib_LTLIBRARIES += src/libout123/modules/output_dummy.la
src_libout123_modules_output_dummy_la_SOURCES = src/libout123/modules/dummy.c
src_libout123_modules_output_dummy_la_LDFLAGS = -module -no-undefined -avoid-version -export-dynamic  -export-symbols-regex '^mpg123_' @DUMMY_LDFLAGS@
src_libout123_modules_output_dummy_la_CFLAGS  = @DUMMY_CFLAGS@
src_libout123_modules_output_dummy_la_LIBADD  = @DUMMY_LIBS@
src_libout123_modules_outout_dummy_la_CPPFLAGS = $(libout123_mod_cppflags)
endif

else

# Static build of one module only.

# TODO: libout123 needs to depend on
# src/libout123/modules/@OUTPUT_MOD@.$(OBJEXT)
src_libout123_modules_output_@OUTPUT_MOD@_CFLAGS = @OUTPUT_CFLAGS@
#all: src/libout123/modules/@OUTPUT_MOD@.$(OBJEXT)

endif
